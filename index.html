<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>메인 홈페이지</title>
  <style>
    :root { color-scheme: light }
    * { box-sizing: border-box }
    html, body { height: 100% }
    body { margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple SD Gothic Neo", "Noto Sans KR", "Malgun Gothic", sans-serif; background: #f6f7fb; color: #111; }
    header { padding: 16px 20px; border-bottom: 1px solid #ddd; background: #fff; }
    h1 { margin: 0; font-size: 18px; }
    .app { display: grid; grid-template-rows: auto 1fr; height: 100% }
    .content { display: grid; grid-template-columns: 280px 1fr; min-height: 0 }
    .sidebar { border-right: 1px solid #ddd; padding: 12px; overflow: auto; background: #fff }
    .list { display: flex; flex-direction: column; gap: 6px }
    .item { display: flex; align-items: center; gap: 8px; padding: 10px; border-radius: 8px; border: 1px solid #ddd; cursor: pointer; user-select: none; background: #fff }
    .item-title { flex: 1 }
    .item-badge { font-size: 12px; color: #666 }
    .item.active { background: #eef6ff; border-color: #9dc2ff }
    .viewer { width: 100%; height: 100%; border: 0 }
    footer { padding: 10px 20px; border-top: 1px solid #ddd; color: #666; font-size: 12px; background: #fff }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1>YuYu Chinese - Review</h1>
    </header>
    <div class="content">
      <aside class="sidebar">
        <div id="list" class="list"></div>
      </aside>
      <section>
        <iframe id="viewer" class="viewer" title="content viewer"></iframe>
      </section>
    </div>
    <footer>
      좌측 제목은 각 폴더의 index.html 헤더에서 자동으로 로드됩니다.
    </footer>
  </div>
  <script>
    const listEl = document.getElementById("list");
    const viewer = document.getElementById("viewer");
    let active = null;
    const items = [
      { folder: "content_08", url: "./content_08/output_index/index.html" },
      { folder: "content_09", url: "./content_09/output_index/index.html" }
    ];

    async function resolveIndexUrl(folder) {
      const tryUrl = async (url) => {
        try {
          const res = await fetch(url, { method: "GET" });
          if (res.ok) return url;
        } catch {}
        return null;
      };
      return (
        (await tryUrl(`./${folder}/output_index/index.html`)) ||
        (await tryUrl(`./${folder}/output_results/index.html`))
      );
    }

    function setActive(el) {
      if (active) active.classList.remove("active");
      active = el;
      if (active) active.classList.add("active");
    }

    async function addItem({ folder, url }) {
      const resolved = await resolveIndexUrl(folder);
      const finalUrl = resolved || url;
      if (!finalUrl) return;
      let title = folder;
      try {
        const html = await fetch(finalUrl).then(r => r.text());
        const doc = new DOMParser().parseFromString(html, "text/html");
        title = doc.title || folder;
      } catch {}
      const el = document.createElement("div");
      el.className = "item";
      const t = document.createElement("div");
      t.className = "item-title";
      t.textContent = title;
      const b = document.createElement("div");
      b.className = "item-badge";
      b.textContent = folder;
      el.appendChild(t);
      el.appendChild(b);
      el.addEventListener("click", async () => {
        setActive(el);
        viewer.src = finalUrl;
      });
      listEl.appendChild(el);
      if (!active) {
        setActive(el);
        viewer.src = finalUrl;
      }
    }

    async function init() {
      for (const item of items) await addItem(item);
    }
    init();
  </script>
</body>
</html>
